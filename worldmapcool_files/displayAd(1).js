
			try{
				try{
					
				}catch(e){}
				
				var _dad = {
					uid        : '149213713360',
					cookies    : {"webid":"","dma":"","make":"","model":"","seg":"","t3seg":"","zip":"","segments":"","motivation":"","stage":"","marketclass":"","offer":"","program":"","customer":"","recommendedModel":"","service":"","purchasetype":"","dtuid":"1600785392983690026","tx_make":"","tx_model":"","tx_marketclass":"","tx_offer":"","tx_stage":"","tx_customer":"","tx_service":""},
					parms      : {"preview":0,"dumpjson":0,"gdebuglevel":0,"cachehost":"view.admission.net","owner":"gmps-ultimate","adtype":"html5-1.1","trackingid":"dap_exponential_lma_buick_retention_de","pa":"cobalt/cautos","layout":"leaderboard","spotw":"728","spoth":"90","postjs":"rf:global:displayad/privacy.js","bannerid":"2026943319123652_728x90","campaignid":"2026943319123652","adm_secure":1,"proto":"https://","spotlight":"1","vertical":"a","params":"detaillink"},
					svrParms   : null,
					providers  : {"Cobalt/CDK":{"encoding":"taxonomy","condition":{"new":"new","used":"used"},"links":{"make":"/VehicleSearchResults?search=[condition]&make=[make]","model":"/VehicleSearchResults?search=[condition]&model=[model]&make=[make]","service":"/ServiceApptForm","directions":"/HoursAndDirections","fallback":"/"}},"Dealer.com":{"encoding":"taxonomy","condition":{"new":"new","used":"used"},"links":{"make":"/[condition]-inventory/index.htm?search=&make=[make]","model":"/[condition]-inventory/index.htm?search=&model=[model]","service":"/service/index.htm","directions":"/dealership/directions.htm","fallback":"/"}},"DealerOn":{"encoding":"taxonomy","condition":{"new":"new","used":"used"},"links":{"make":"/search[condition].aspx?Make=[make]","model":"/search[condition].aspx?Make=[make]&Model=[model]","service":"/service.aspx","directions":"/hours.aspx","fallback":"/"}},"Dealer Inspire":{"encoding":"taxonomy_double_enc","condition":{"new":"New","used":"Used"},"links":{"make":"/[condition]-vehicles/?_dFR%5Bmake%5D%5B0%5D=[make]&_dFR%5Btype%5D%5B0%5D=[condition]","model":"/[condition]-vehicles/?_dFR%5Bmake%5D%5B0%5D=[make]&_dFR%5Bmodel%5D%5B0%5D=[model]&_dFR%5Btype%5D%5B0%5D=[condition]","service":"/service/","directions":"/hours-and-directions/","fallback":"/"}},"Dealer Fire":{"encoding":"taxonomy","condition":{"new":"n","used":"u"},"links":{"make":"/inventory?t=[condition]&make[]=[make]","model":"/inventory?t=[condition]&make[]=[make]&model[]=[model]","service":"/our-services","directions":"/contact-us","fallback":"/"}},"fusionZONE":{"encoding":"taxonomy","condition":{"new":"new","used":"used"},"links":{"make":"/inventory?make=[make]&type=[condition]","model":"/inventory?make=[make]&model=[model]&type=[condition]","service":"/directions","directions":"/schedule-service","fallback":"/"}},"Dealer eProcess":{"encoding":"taxonomy","condition":{"new":"new","used":"used"},"links":{"make":"/search/?tp=[condition]","model":"/search/?tp=[condition]","service":"/service-department/","directions":"/directions/","fallback":"/"}},"NabThat":{"encoding":"taxonomy","condition":{"new":"new","used":"used"},"links":{"make":"/inventory/[condition]-vehicles/","model":"/inventory/[condition]-vehicles/models=[make]_[model]","service":"/service-center/","directions":"/hours-directions/","fallback":"/"}},"FOX Dealer":{"encoding":"taxonomy","condition":{"new":"new","used":"used"},"links":{"make":"/inventory/?type=[condition]&make=[make]","model":"/inventory/?type=[condition]&make=[make]&model=[model]","service":"/serviceapptform/","directions":"/hours-directions/","fallback":"/"}},"SM360":{"encoding":"taxonomy","condition":{"new":"new","used":"used"},"links":{"make":"/","model":"/","service":"/","directions":"/","fallback":"/"}},"eDealer.ca":{"encoding":"taxonomy","condition":{"new":"new","used":"used"},"links":{"make":"/[condition]/[make].html","model":"/[condition]/[make]-[model].html","service":"/service/appointment/","directions":"/contact/","fallback":"/"}},"Remora":{"encoding":"taxonomy","condition":{"new":"new=true&type=new","used":"new=false&type=used"},"links":{"make":"/vehicles?[condition]&make=[make]","model":"/vehicles?[condition]&make=[make]&model=[model]","service":"/service","directions":"/contact","fallback":"/"}}},
					admCookies : {"dtuid":"1600785392983690026"}
				};

				if ((typeof(extParams) != 'undefined') && extParams.uniqueid){
					_dad.uid = extParams.uniqueid;
					delete extParams.uniqueid;
				}
				_dad.onError=function(msg) {};
				
				

				if (typeof(extParams) != 'undefined'){
					if (0 && typeof(extParams.contact_id) != 'undefined')
						delete extParams.contact_id;

					for (var key in extParams){
						
						_dad.parms[key] = extParams[key];
						delete extParams[key];
					}
				}

				_dad.resolveCookieVals = function(val){
					var outval = val;
					if (typeof(val) == 'string'){
						var alphaSort = "";
						var re = '';
						if (val.indexOf('{ck:') != -1)
							re  = /{ck:(\w+)}/g;
						else if (val.indexOf('%7Bck%3A') != -1)
							re  = /%7Bck%3A(\w+)%7D/g;
						if (re != ''){
							var m = "";
							while (m = re.exec(val)){
								var ckName = m[1];
								if (ckName.indexOf('dt_') === 0)
									ckName = ckName.substr(3);
								if (typeof(_dad.cookies[ckName]) != 'undefined'){
									var ckVal = _dad.cookies[ckName];
									if (ckVal.match(/^_(.+)_$/))
										ckVal = RegExp.$1.replace(/_/g,',');

									// Sort alphabetically if configured in displayad.json to aid search request cache-ability
									if (ckVal.indexOf(',') != -1 && alphaSort.indexOf(ckName) != -1)
										ckVal = ckVal.split(',').sort().join(',');
									
									outval = outval.replace(m[0], ckVal);
								}
							}
						}
					}

					return outval;				
				};

				for (var key in _dad.parms)
					_dad.parms[key] = _dad.resolveCookieVals(_dad.parms[key]);
				
				_dad.replaceAdParms = function(str){
					var result = str;
					if (str){
						result = str.toString().replace(/{ad:([\w\.]+)}/g, function(m_all, m_g1) {
							return encodeURIComponent(_dad.parms[m_g1.replace(/\W+/g, '_')] || _dad.parms[m_g1.replace(/\W+/g, '')] || '');
						});				
					}
					return result;
				};

				_dad.adClicked = function(){
					if (this.parms.pubclick_pixeltracker){
						if (Array.isArray(this.parms.pubclick_pixeltracker)){
							this.parms.pubclick_pixeltracker.forEach(function(url, index){
								if (url && url.length)
									(new Image()).src = _dad.replaceAdParms(url);
							});
						}
						else
							(new Image()).src = this.replaceAdParms(this.parms.pubclick_pixeltracker);
					}
				};			
				// CDK HTML5 Ad Library
// Copyright (c) 2020 Sincro, LLC.
if(!window.adm||typeof window.adm!="object")window.adm={};if(adm.htmlad){adm.force_iframe=true}else adm.htmlad={version:"1.1.103",id:""+Date.now().toString(36)+"-"+Math.floor(Math.random()*9007199254740991).toString(36),cacheHost:"view-preprod.admission.net",s3HostMap:{"view.dev.ca.admission.net":"media.dev.ca.admission.net","cdn-preprod.admission.net":"media.stage.admission.net","cdn.admission.net":"media.admission.net"},proto:location.protocol.match(/https/i)?"https:":"http:",debug:false,nextRequestId:1,callbacks:{},listeners:{},requiredParams:["pa","bannerid","trackingid"],defaultParams:{_eol_:"<br/>\n",spotlight:1,vertical:"a",maxadnails:5,params:"*",norf:1,maxdesclength:80,image_resize_mode:"Fit",image_suffix:"&t=ticc/pro:",image_suffix_jpg:"&t=ts/q:70",image_suffix_png:"&t=tq/co:256/di:false",inv_orientation:"horiz",inv_scroll_speed:3,inv_auto_scroll:1,inv_mouse_scroll:.25,inv_scroll_degrade:.995,inv_ss_enable:0,inv_ss_ease:.125,inv_ss_load_padding:0,inv_static:1,inv_s3:1},defaultStyles:{img_logo:{"background-repeat":"no-repeat","background-position":"center center","background-size":"auto"},inv_thumb:{"background-repeat":"no-repeat","background-position":"center center","background-size":"auto"}},vendorPrefix:"",cssStdProps:new RegExp("^(background|background\\-attachment|background\\-color|background\\-image|background\\-position|background\\-position\\-x|background\\-position\\-y|background\\-repeat|border|border\\-bottom|border\\-bottom\\-color|border\\-bottom\\-style|border\\-bottom\\-width|border\\-collapse|border\\-color|border\\-left|border\\-left\\-color|border\\-left\\-style|border\\-left\\-width|border\\-right|border\\-right\\-color|border\\-right\\-style|border\\-right\\-width|border\\-spacing|border\\-style|border\\-top|border\\-top\\-color|border\\-top\\-style|border\\-top\\-width|border\\-width|bottom|clear|clip|color|cursor|direction|display|filter|float|font|font\\-family|font\\-size|font\\-size\\-adjust|font\\-stretch|font\\-style|font\\-variant|font\\-weight|height|left|letter\\-spacing|line\\-break|line\\-height|list\\-style|list\\-style\\-image|list\\-style\\-position|list\\-style\\-type|margin|margin\\-bottom|margin\\-left|margin\\-right|margin\\-top|marker\\-offset|max\\-height|max\\-width|min\\-height|min\\-width|orphans|outline|outline\\-color|outline\\-style|outline\\-width|overflow|overflow\\-X|overflow\\-Y|padding|padding\\-bottom|padding\\-left|padding\\-right|padding\\-top|position|right|size|table\\-layout|text\\-align|text\\-align\\-last|text\\-decoration|text\\-indent|text\\-justify|text\\-overflow|text\\-shadow|text\\-transform|text\\-autospace|text\\-kashida\\-space|text\\-underline\\-position|top|vertical\\-align|visibility|white\\-space|widows|width|word\\-break|word\\-spacing|word\\-wrap|writing\\-mode|z\\-index|zoom)$"),searchExcludeKeys:new RegExp("^(_|inv_|oas_|txt|img|colors|bannerid|trackingid|trackingredirecturl|dogtag|cache|usersource|uid|layout|spotw|spoth|prejs|postjs|lqs|proto|autorefer|wmode|dumpjson|gdebuglevel|debug|image_|adcreator_|owner|protocol|torque|creative|campaign|system|session|place|imp|pubclick|size|chan|cb|da_|click|backup|defaulturl|dtuid|ep$|pr$|user_|prog|sid|fastload|jpeg_|png_|oid|camptags|timeStamp|special_|viewpixels)"),offerResponseKeys:new RegExp("^(ID|Additionalterms|Copy|Custom|Exclusions|Imageslots|Legal|Offertypes|Offervehicles|Scope|Style|Subtitle)","i"),dynamicDealerTextParams:["txt_title","txt_address","txt_address2","txt_city","txt_state","txt_zip","txt_phone","txt_email","txt_displayurl","txt_tagline"],adSizeShortcuts:{lb:"leaderboard",mr:"mediumrectangle",ws:"wideskyscraper",hp:"halfpage",mb:"mobilebanner",ct:"catfishtall",cs:"catfishshort",ms:"mobilesmall",mm:"mobilemedium",ml:"mobilelarge",sn:"smartphonenarrow",sw:"smartphonewide",ts:"tabletshort",trt:"tabletrecttall",trw:"tabletrectwide",tlw:"tabletleaderwide",tl:"tabletleader",pt:"portrait",fs:"filmstrip",bt:"button",ot:"onetile",tb:"toolbar",ss:"smallskyscraper"},clickRemaps:[[/^https?\:\/\/(www\.)?buickdealer\.com.*$/i,"https://www.buick.com/locate-buick-dealer"],[/^https?\:\/\/(www\.)?cadillacdealer\.com.*$/i,"https://www.cadillac.com/locate-dealer"],[/^https?\:\/\/(www\.)?chevydealer\.com.*$/i,"https://www.chevrolet.com/chevydealer"],[/^https?\:\/\/(www\.)?gmcdealer\.com.*$/i,"https://www.gmc.com/locate-gmc-dealer"]],animationDefaults:{"animation-fill-mode":"both",visibility:"visible","backface-visibility":"visible","transform-origin":"50% 50%"},animationTimers:null,animationAutoplay:true,images:{},domRetries:64,apiTimeout:10,fontTimeout:5,logErrorPct:100,shownAlert:false,timers:{},cookies:{},pixels:[],errors:[],run:function(args,userCallback){var self=this;if(adm.domLoaded){if(adm.mraid&&mraid.getState()==="loading"){mraid.addEventListener("ready",function(){self.loadAd(args,userCallback)})}else self.loadAd(args,userCallback)}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){self.run(args,userCallback)},false)}else{window.attachEvent("onload",function(){self.run(args,userCallback)})}},doError:function(msg){this.trace("HTML Ad Error: "+msg);if(!this.cacheHost.match(/^\w+\.(prod\.)?admission\.net$/)&&!this.shownAlert){this.shownAlert=true;alert("HTML Ad Error: "+msg)}if(this.params&&!this.params.local&&!this.params.preview){this.logEvent("error",{message:"Internal Error: "+msg,internal:true})}return false},prepParams:function(params){this.query=adm.parseQueryString(location.href);if(this.query.adm_hostname){this.cacheHost=this.query.adm_hostname}if(!params)params={};this.params=params;for(var key in this.defaultParams){if(typeof params[key]=="undefined"){params[key]=this.defaultParams[key]}}if(this.args.flashvars){for(var key in this.args.flashvars){params[key]=this.args.flashvars[key]}}if(window._dad&&_dad.parms){for(var key in _dad.parms){params[key]=_dad.parms[key]}}if(!params.dealerzip){var scripts=document.getElementsByTagName("script");for(var idx=0,len=scripts.length;idx<len;idx++){var url=scripts[idx].getAttribute?scripts[idx].getAttribute("src"):scripts[idx].src;if(url&&url.match&&url.match(/\bdealerzip\=([^\&]+)/)){params.dealerzip=adm.decodeURIComponent(RegExp.$1)}}}if(window.extParams){for(var key in extParams){params[key]=extParams[key]}}try{var ref_query=adm.parseQueryString(""+document.referrer);for(var rkey in ref_query){if(rkey.match(/^adm_(\w+)$/)){var key=RegExp.$1;params[key]=ref_query[rkey]}}}catch(e){}for(var qkey in this.query){if(qkey.match(/^adm_(\w+)$/)){var key=RegExp.$1;params[key]=this.query[qkey]}}if(params.sqs){var sqs=adm.parseQueryString(adm.decodeURIComponent(params.sqs));for(var key in sqs){params[key]=sqs[key]}delete params.sqs}if(params.lqs){var lqs=adm.parseQueryString(params.lqs);for(var key in lqs){params[key]=lqs[key]}}var cookies=this.cookies=adm.parseCookies();if(params.preview&&!params.bannerid)params.bannerid="preview";if(params.preview&&!params.trackingid)params.trackingid="preview";for(var idx=0,len=this.requiredParams.length;idx<len;idx++){if(typeof params[this.requiredParams[idx]]=="undefined"){return this.doError("Missing required parameter: "+this.requiredParams[idx])}}if(params.gdebuglevel||params.debug||params.preview||cookies.ADMDEBUG)this.debug=true;this.trace("Initializing AdMission HTML5 Display Ad Engine - version "+this.version);if(this.debug)this.trace("Cookies: "+JSON.stringify(cookies));for(var key in params){if(params[key]==null)params[key]="";else if(typeof params[key]=="undefined")params[key]="";try{if(typeof params[key]=="string"&&params[key]&&params[key].match&&params[key].match(/\{ck\:(\w+)\}/)){params[key]=params[key].replace(/\{ck\:(\w+)\}/g,function(m_all,m_g1){return cookies[m_g1.replace(/^dt_/,"")]||""})}}catch(e){}}if(params.cachehost)this.cacheHost=params.cachehost;this.trace("Cache Host: "+this.cacheHost);if(params.dom_retries)this.domRetries=parseInt(params.dom_retries);this.domTimeout=Math.floor(this.domRetries*250/1e3);if(!params.layout&&location.href&&location.href.match&&location.href.match(/(\w+)\.html$/)){params.layout=RegExp.$1}if(this.query["cs:adm:o"]&&params.offer_common)params.adlist="offers:"+this.query["cs:adm:o"];if(params.preview)try{var top_query=adm.parseQueryString(top.location.href);if(top_query){for(var qkey in top_query){if(qkey.match(/^(adm|preview)_(\w+)$/)){var key=RegExp.$2;params[key]=top_query[qkey]}}}}catch(e){}return params},loadAd:function(args,userCallback){var self=this;this.args=args;if(adm.hooks){for(var key in adm.hooks)this.on(key,adm.hooks[key])}this.dispatchEvent("init");var params={};if(args.params){for(var key in args.params)params[key]=args.params[key]}if(args.features&&args.features.inventory){params.inventory=args.features.inventory}else params.inventory=0;if(!this.prepParams(params))return;if("adchoices"in params&&params.adchoices==0){var sty=document.createElement("style");sty.innerHTML="#BAP-holder, .bap-trigger { display: none !important; visibility: hidden !important; opacity: 0 !important; left:-9999px !important; }";document.head.appendChild(sty);params.noevfix=true}if(Object.keys(Object.prototype).length){this.trace("Object.prototype has been mutilated: "+Object.keys(Object.prototype).join(","));Object.keys(Object.prototype).forEach(function(key){delete Object.prototype[key]})}if(window.adSettings&&adSettings.overlay&&adSettings.overlay.video){params.reel_video=adSettings.overlay.video}if(args.features&&args.features.offer&&params.offer_version){params.inventory=1}if(this.debug)this.trace("Params: "+JSON.stringify(params));var ua=navigator.userAgent;if(ua.match(/MSIE/))this.vendorPrefix="ms";else if(ua.match(/WebKit/))this.vendorPrefix="webkit";else if(ua.match(/Opera/))this.vendorPrefix="webkit";else if(ua.match(/Gecko/))this.vendorPrefix="moz";this.trace("CSS Vendor Prefix: "+this.vendorPrefix);this.legacy=!!ua.match(/MSIE\s+[6789]/);this.cssAnimationSupport=false;if(ua.match(/MSIE\s+(\d+\.\d+)/)&&parseFloat(RegExp.$1)>=10)this.cssAnimationSupport=true;else if(ua.match(/Trident.+rv\:(\d+)/)&&parseFloat(RegExp.$1)>=11)this.cssAnimationSupport=true;else if(ua.match(/Chrome\/(\d+\.\d+)/)&&(parseFloat(RegExp.$1)>=4&&parseFloat(RegExp.$1)<=23||parseFloat(RegExp.$1)>=33)){this.cssAnimationSupport=true}else if(ua.match(/Version\/([\d\.]+).+Safari/)&&parseFloat(RegExp.$1)>=4)this.cssAnimationSupport=true;else if(ua.match(/Firefox\/(\d+\.\d+)/)&&parseFloat(RegExp.$1)>=16)this.cssAnimationSupport=true;else if(ua.match(/Opera\D+(\d+\.\d+)/)&&parseFloat(RegExp.$1)>=12)this.cssAnimationSupport=true;else if(ua.match(/PhantomJS/))this.cssAnimationSupport=true;else if(ua.match(/Edge/))this.cssAnimationSupport=true;if("animation"in params){this.cssAnimationSupport=params.animation==1?true:false}if(!this.cssAnimationSupport)params.inv_auto_scroll=0;this.trace("CSS Animation: "+(this.cssAnimationSupport?"Enabled":"Disabled"));this.retina=window.devicePixelRatio>1&&args.features&&(args.features.retina||args.features.hero);if("retina"in params)this.retina=params.retina==1;this.trace("Retina Image Support: "+(this.retina?"Enabled":"Disabled"));this.mobile=!!ua.match(/iPhone|Android|BlackBerry|Mobile/);if(params.mobile)this.mobile=true;if(params.jpeg_quality)params.image_suffix_jpg="&t=ts/q:"+params.jpeg_quality;if(params.png_colors)params.image_suffix_png="&t=tq/co:"+params.png_colors+"/di:false";if(params.image_progressive&&params.image_hideload!=1){params.image_suffix_jpg+="&t=ts/interlace:jpeg";params.image_suffix_png+="&t=ts/interlace:plane"}if(args.animationDefaults){for(var key in args.animationDefaults){this.animationDefaults[key]=args.animationDefaults[key]}}for(var key in params){if(key.match(/^_?img_/)&&!key.match(/_u$/)&&!this.defaultStyles[key]&&this.defaultStyles["img_logo"]){this.defaultStyles[key]=this.defaultStyles["img_logo"]}}if("inv_static"in params)params.inv_static=parseFloat(params.inv_static);if(params.inv_s3==0||params.inv_s3=="0")params.inv_s3=0;if(params.inv_s3){params.inv_s3=this.params.inv_s3=this["s3HostMap"][this.cacheHost]||false;if(params.inv_s3)this.trace("Using S3 for inventory: "+params.inv_s3);else this.trace("No S3 hostname found for: "+this.cacheHost)}if((params.inv_s3||params.inv_static)&&this.defaultStyles.inv_thumb)delete this.defaultStyles.inv_thumb;this.styles={};for(var id in this.defaultStyles){this.styles[id]=this.defaultStyles[id]}if(args.styles){for(var id in args.styles)this.styles[id]=args.styles[id]}this.setStyles(this.styles);if(args.fonts)this.loadFonts(args.fonts);if(args.callbacks){for(var key in args.callbacks)this.callbacks[key]=args.callbacks[key]}if(args.hooks){for(var key in args.hooks)this.on(key,args.hooks[key])}if((params.dap||params.offer_common)&&!params.contacts&&(params.contactid||params.contact_id)){params.contacts=2;params.dap=1}if(params.img_video&&window.adSettings&&adSettings.overlay){adSettings.overlay.video=params.img_video;if(adSettings.overlay.video.match(/^rf\:([^\:]+)\:(.+)$/)){adSettings.overlay.video=this.proto+"//"+this.cacheHost+"/abc/assets/"+RegExp.$1+"/"+RegExp.$2}self.trace("Creative video replacement for Reel: "+adSettings.overlay.video)}if(params.fetchserverdata||params.inventory||params.t3search||params.dealerzip||params.contacts||params.offer_common){adm.hide("inv_fallback");adm.hide("dealer_fallback");adm.show("inv_loading");this.trace("Performing search API call");var callbackId="c"+this.nextRequestId++;this.callbacks[callbackId]=function(response){self.callbacks[callbackId]=function(){};if(self.timers[callbackId]){clearTimeout(self.timers[callbackId]);delete self.timers[callbackId]}adm.hide("inv_loading");if(response.Search)response=response.Search;self.lastResponse=response;self.dispatchEvent("search_complete",response);if(self.debug)self.trace("Got response from AdMission Server: "+JSON.stringify(response));if(response.Code!=0){self.doError(response.Description)}if(response.Ad&&response.Ad.length){for(var idx=0,len=response.Ad.length;idx<len;idx++){var ad=response.Ad[idx];for(var key in ad.Parameters){if(!ad[key])ad[key]=ad.Parameters[key]}delete ad.Parameters;if(ad.Primaryimage)ad.ImageURL=ad.BaseURL+ad.Primaryimage;if(!ad.Display)ad.Display={};if(!ad.Displayprice&&ad.Askingprice&&ad.Askingprice.toString().match(/^[\d\.]+$/)){ad.Displayprice=adm.price_usd_int(ad.Askingprice)}}if(self.params.offer_common){var offer=response.Ad[0];self.lastOffer=offer;if(!offer.ID)offer.ID="FILLER";self.trace("Response contains offer (ID: "+offer.ID+")");var spot_args={};if(response.Parameters&&response.Parameters.SpotlightListingArgs){var spot_arg_list=response.Parameters.SpotlightListingArgs.split(/\,\s*/);for(var idx=0,len=spot_arg_list.length;idx<len;idx++){spot_args[spot_arg_list[idx].toLowerCase()]=1}}for(var key in offer){var pkey="offer_"+key.toLowerCase();if(key.match(self.offerResponseKeys)||spot_args[key.toLowerCase()]||adm.$(pkey)){self.params[pkey]=offer[key]}}if(adm.$("img_offer_default")){self.params["img_offer_default"]=offer.ImageURL}if(offer.Imageslots){var slot_list=offer.Imageslots.split(/\,\s*/);var image_slots={};for(var idx=0,len=slot_list.length;idx<len;idx++){var layout=slot_list[idx];image_slots[layout]=1}for(var key in self.params){if(key.match(/^_?img_offer_(\w+)$/)){var layout=RegExp.$1;if(image_slots[layout]&&adm.$(key)){var fmt=layout.match(/^ls/)?"jpg":"png";self.params[key]=offer.BaseURL+layout+"."+fmt}}}if(image_slots["video"]&&window.adSettings&&adSettings.overlay){adSettings.overlay.video=offer.BaseURL+"video.mp4";self.trace("Offer video replacement for Reel: "+adSettings.overlay.video)}}}else{self.trace("Response contains inventory ("+response.Ad.length+" vehicles)")}}if(response.Contact&&response.Contact[0]){self.trace("Response contains dealer ("+response.Contact[0].ID+")");var contact=response.Contact[0];self.params.contact_id=self.params.contactid=contact.ID;self.lastContact=contact;adm.hide("dealer_fallback");if(self.params.dap){for(var key in contact){if(key!="ID"&&key!="Type"&&!key.match(/^txt_/)){self.params[key]=contact[key]}}if(contact.ctn_swap&&contact.txt_phone)self.params.txt_phone=contact.txt_phone}else{for(var idx=0,len=self.dynamicDealerTextParams.length;idx<len;idx++){self.params[self.dynamicDealerTextParams[idx]]=""}for(var key in contact){if(key!="ID"&&key!="Type"){if(key.match(/_u$/)&&self.params[key]&&self.params[key].toString().match(/\;(\w+)$/)){self.params[key]=contact[key]+";"+RegExp.$1}else self.params[key]=contact[key]}}}if(window._dad&&_dad.parms){for(var key in self.params){_dad.parms[key]=self.params[key]}}}else{self.dealerFallback()}self.prepTextFields();self.waitForWindowSize(function(){self.dispatchEvent("pre_image");self.loadImages(function(){if(!self.params.fastload)self.dispatchEvent("images_complete");self.allImagesLoaded=true;self.waitForFonts(function(){self.dispatchEvent("load_complete");self.setStyles(self.styles);self.populateDOMElements();if(args.features.inventory)self.prepInventory();if(args.features.inventory&&response.Ad&&response.Ad.length){self.showInventory(response.Ad)}else{self.hideInventory();self.dispatchEvent("inv_fallback")}self.fireDogtag();if(self.animationAutoplay)self.animatePlay();if(userCallback){self.trace("Firing user callback");userCallback.call(window,response)}self.dispatchEvent("complete");self.trace("Ad complete");setTimeout(function(){self.fixEvidon()},1e3)})})})};params.format="json";params.callback="adm.htmlad.callbacks."+callbackId;params.encode="gzip";if(!this.debug)params.compress=1;if(params.dealerzip&&!params.dealerzip.toString().match(/\d{5}/)){this.trace("Malformed dealerzip: "+params.dealerzip+", clearing param");params.dealerzip=""}if(params.offer_common&&params.accounts&&params.preview){params.filler=1;delete params.accounts;if(params.pa=="adm/sample"){params.pa="cobalt/cautos"}}params.view_hostname=this.cacheHost;params.utf8=1;if("inventory"in params&&params.inventory==0||params.offer_common)delete params.tags;if(params.contactid||params.contact_id)delete params.dealerzip;if(params.offer_common&&(params.contactid=="special-fallback"||params.contact_id=="special-fallback"))delete params.t3search;this.tagPrep(params);if(params.adlist)params.filler=0;this.iCookiePrep();if(params.offer_make)params.offer_make=params.offer_make.replace(/\W+/g,"").toLowerCase();if(params.offer_model)params.offer_model=params.offer_model.replace(/\W+/g,"").toLowerCase();if(params.offer_trim)params.offer_trim=params.offer_trim.replace(/\W+/g,"").toLowerCase();if(this.proto=="https:")params.https=1;if(params.preview){params.ttl=60;params.db="AdMissionClassified"}this.dispatchEvent("pre_search",params);var paramKeys=[];for(var key in params){if(!key.match(this.searchExcludeKeys)){paramKeys.push(key)}}paramKeys=paramKeys.sort();var url=this.proto+"//"+this.cacheHost+"/rimfire/admission/search";if(params.source)url+="/v3.0/"+params.source;else url+="/v2.0";for(var idx=0,len=paramKeys.length;idx<len;idx++){var key=paramKeys[idx];var value=params[key];url+=(!idx?"?":"&")+key+"="+escape(value)}if(this.params["_adm_server_response"]){setTimeout(function(){adm.htmlad.callbacks[callbackId](adm.htmlad.params["_adm_server_response"])},0)}else{this.trace("Search API URL: "+url);this.timeStart=adm.timeNow();this.apiURL=url;this.timers[callbackId]=setTimeout(function(){if(adm.htmlad.callbacks[callbackId]){adm.htmlad.callbacks[callbackId]({Code:500,Description:"Search API Timeout Error ("+adm.htmlad.apiTimeout+" seconds)"})}},this.apiTimeout*1e3);var scr=document.createElement("script");scr.type="text/javascript";scr.async=true;scr.src=url;var firstScript=document.getElementsByTagName("script")[0];firstScript.parentNode.insertBefore(scr,firstScript)}}else{this.trace("Basic ad only, skipping server API call");this.dispatchEvent("pre_search",params);this.dispatchEvent("search_complete",{Basic:1});this.iCookiePrep();this.prepTextFields();this.waitForWindowSize(function(){self.dispatchEvent("pre_image");self.loadImages(function(){if(!self.params.fastload)self.dispatchEvent("images_complete");self.allImagesLoaded=true;self.waitForFonts(function(){var self=adm.htmlad;self.dispatchEvent("load_complete");self.setStyles(self.styles);self.populateDOMElements();self.fireDogtag();if(self.animationAutoplay)self.animatePlay();if(userCallback){self.trace("Firing user callback");userCallback.call(window,{Basic:1})}self.dispatchEvent("complete");self.trace("Ad complete");setTimeout(function(){self.fixEvidon()},1e3)})})})}},loadFont:function(key){var self=this;var fonts=this.args.fonts;var src=fonts[key];if(!src||!src.match)return;if(src.match(/^rf\:([^\:]+)\:(.+)$/)){src=this.proto+"//"+this.cacheHost+"/abc/assets/"+RegExp.$1+"/"+RegExp.$2}if(src.match(/\.(\w+)(\?|$)/)){var fmt=RegExp.$1;this.trace("Loading web font: "+key+": "+src);this.fontLoadCounter++;var http=new XMLHttpRequest;http.onload=function(){self.fontLoadCounter--;if(this.status==200||this.status===0){var b64=arrBufToB64(http.response);var sty=document.createElement("style");sty.type="text/css";sty.innerHTML="@font-face { font-family:'"+key+"'; src:url(data:application/font-"+fmt+";charset=utf-8;base64,"+b64+") format('"+fmt+"'), url("+src+"); }\n";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(sty)}else{self.doError("Web Font Failed: "+src+": HTTP "+this.status+" "+this.statusText)}http=null};http.open("GET",src,true);http.responseType="arraybuffer";http.send(null)}else this.doError("Invalid font URL: "+src)},loadFonts:function(){var fonts=this.args.fonts;if(!fonts||this.legacy)return;this.fontLoadCounter=0;for(var key in fonts){this.loadFont(key)}},waitForFonts:function(callback){var self=this;var start_time=adm.timeNow();var fonts=this.args.fonts;if(!fonts||this.legacy)return callback();var checkLoad=function(){if(!self.fontLoadCounter){self.trace("All web fonts loaded successfully.");return callback()}if(adm.timeNow()-start_time>=self.fontTimeout){self.doError("Failed to load web fonts after "+self.fontTimeout+" seconds, continuing without them.");return callback()}setTimeout(checkLoad,100)};checkLoad()},fireDogtag:function(){var self=this;if(this.fired)return;this.fired=true;if(this.params.replay)return;var pixels=this.params.viewpixels||[];if(typeof pixels=="string")pixels=[pixels];if(this.params.dogtag)pixels.push(this.params.dogtag);if(pixels.length){for(var idx=0,len=pixels.length;idx<len;idx++){var pixel=pixels[idx];pixel=pixel.toString().replace(/\{ad\:([\w\.]+)\}/g,function(m_all,m_g1){return encodeURIComponent(self.params[m_g1.replace(/\W+/g,"_")]||self.params[m_g1.replace(/\W+/g,"")]||"")});var pixel_query=adm.parseQueryString(pixel);if(pixel_query["cs:s"]=="special-fallback"&&pixel_query["t2webid"]){pixel=pixel.replace(/([\?\&]cs\:s\=)([\w\-]+)/,"$1"+pixel_query["t2webid"])}if(this.params.audit){if(pixel_query["cs:e"])pixel=pixel.replace(/([\?\&]cs\:e\=)([^\&]*)/,"$1rtbqualitycheck");else pixel+=(pixel.match(/\?/)?"&":"?")+"cs:e=rtbqualitycheck"}this.dispatchEvent("viewthru",pixel);this.trace("Firing viewthru pixel: "+pixel);pixels[idx]=new Image;pixels[idx].onerror=function(){self.doError("Failed to load viewthru pixel: "+this.src)};pixels[idx]._origSrc=pixel;pixels[idx].src=pixel}}this.pixels=pixels;if(this.cookies.ADMSNIFFER&&!this.params.preview&&this.params.adcreator_order){this.sniffAd()}},sniffAd:function(){if(!this.cookies.ADMSNIFFER||!this.cookies.ADMSNIFFER.match(/^on\-(\w+)$/))return;var smell=RegExp.$1;var data={smell:smell,id:this.id,epoch:Date.now()/1e3,proto:this.proto,url:""+location.href,ref:""+document.referrer,host:""+location.host,ua:navigator.userAgent,tp:window.tp||false,params:this.params||false,api:this.apiURL||"",width:this.width||0,height:this.height||0,pixels:this.pixels.map(function(pixel){return pixel._origSrc}),errors:this.errors,images:[]};if(this.lastContact)data.contact_id=this.lastContact.ID;if(this.lastOffer)data.offer_id=this.lastOffer.ID;if(this.args.fonts)data.fonts=this.args.fonts;for(var key in this.images){if(this.images[key].img)data.images.push(this.images[key].img.src)}if(this.inv&&this.inv.ads){data.inventory=this.inv.ads.map(function(ad){return ad.ID})}this.sendSniff(data)},preSniffAd:function(){if(location.href.match&&location.href.match(/[\?\&]adm_replay\=1\b/))return;if(window._dad&&_dad.parms&&_dad.parms.preview)return;if(window.extParams&&extParams.preview)return;if(!window._dad||!_dad.admCookies||!_dad.admCookies.ADMSNIFFER||!_dad.admCookies.ADMSNIFFER.match(/^on\-(\w+)$/))return;var smell=RegExp.$1;var data={smell:smell,id:this.id,epoch:Date.now()/1e3,proto:this.proto,url:""+location.href,ref:""+document.referrer,host:""+location.host,ua:navigator.userAgent,tp:window.tp||false,preload:true};this.sendSniff(data)},sendSniff:function(data){var self=this;if(document.documentElement&&document.documentElement.outerHTML)data.html=document.documentElement.outerHTML;else if(document.documentElement&&document.documentElement.innerHTML)data.html=document.documentElement.innerHTML;else data.html=document.body.innerHTML;data.html=data.html.replace(/<style[^>]*>[\S\s]*?<\/style>/gi,"");var log_host="cdn.admission.net";if(window._dad&&_dad.parms&&_dad.parms.cachehost)log_host=_dad.parms.cachehost;else if(window.extParams&&extParams.cachehost)log_host=extParams.cachehost;log_host=log_host.replace(/^\w+/,"apps");var url=this.proto+"//"+log_host+"/webapp/adsniffer/api.php?action=submit";var payload=JSON.stringify(data)+"\n";var http=new XMLHttpRequest;http.onload=function(){if(this.status==200)self.trace("Sniff submission to "+log_host+" completed succesfully.");else self.doError("Sniff Submission Failed: "+url+": HTTP "+this.status+" "+this.statusText);http=null};http.open("POST",url,true);http.setRequestHeader("Content-Type","text/plain");http.send(payload)},tagPrep:function(params){if(params.tags&&params.tags.match(/^[\w\,\|]+([\,\|]all)$/)){var suffix=RegExp.$1;var models=params.tags.replace(/([\,\|]all)$/,"").split(/\,/);if(models.length>3){models.splice(3,models.length);params.tags=models.join(",")+suffix}}if(params.special_tag){if(params.tags){params.tags=params.special_tag+"&("+params.tags+")"}else{params.tags=params.special_tag}}},fixEvidon:function(){if(document.querySelectorAll&&!this.params.noevfix){var temp=adm.$("adm_htmlad_container");if(temp&&temp.offsetHeight&&!temp.offsetLeft&&!temp.offsetTop){var y=Math.floor(temp.offsetHeight-17);var elems=document.querySelectorAll("span.bap-trigger");for(var idx=0,len=elems.length;idx<len;idx++){this.trace("Moving Evidon element into place: "+elems[idx].id);elems[idx].style.left="1px";elems[idx].style.top=""+y+"px"}}}},iCookiePrep:function(){if(this.args.icookies&&!this.params._disable_icookies){for(var param_name in this.args.icookies){var param_value=this.params[param_name];if(param_value){var icookie=this.args.icookies[param_name];var keys=(""+param_value).split(/\,\s*/);this.trace("Searching for iCookies: "+param_name+": "+param_value);var ckey_map={};for(var key in icookie.key_map){var ckey=key.replace(/\W+/g,"").toLowerCase();ckey_map[ckey]=icookie.key_map[key]}for(var idx=0,len=keys.length;idx<len;idx++){var key=keys[idx].replace(/\W+/g,"").toLowerCase();if(ckey_map[key]){var text_value=ckey_map[key];this.trace("Matched iCookie for: "+param_name+": "+key);if(icookie.image_param&&typeof this.params[icookie.image_param]!="undefined"){this.params[icookie.image_param]=this.params[icookie.image_param].replace(/\/$/,"").replace(/\/[^\/]+$/,"")+"/"+icookie.image_filename_prefix+key+icookie.image_filename_suffix;this.trace("Replaced image param for iCookie: "+icookie.image_param+": "+this.params[icookie.image_param])}if(typeof text_value=="object"){for(var sub_key in text_value){var sub_value=text_value[sub_key];this.params[sub_key]=sub_value;this.trace("Replaced param for iCookie: "+sub_key+": "+sub_value)}}else if(icookie.text_param&&typeof this.params[icookie.text_param]!="undefined"){this.params[icookie.text_param]=text_value;this.trace("Replaced text param for iCookie: "+icookie.text_param+": "+text_value)}this.params[param_name]=key;if(icookie.callback)icookie.callback(key,text_value);this.dispatchEvent("icookie",param_name,key,text_value);idx=len}}}}}},iCookieGetValue:function(param_name,key){if(this.args.icookies&&this.args.icookies[param_name]){if(key)return this.args.icookies[param_name].key_map[key];else return this.args.icookies[param_name].key_map}else return null},prepTextFields:function(){var eol=this.param("_eol_");var layout=this.param("layout");var shortcuts=this.adSizeShortcuts;for(var key in this.params){if(key.match(/^_?txt_/)){var value=""+this.param(key);if(value.match(/\[(\w+)\]/)){value=value.replace(/\[(\w+)\]/g,function(m_all,m_g1){m_g1=m_g1.toLowerCase();if(m_g1=="br")return"\n";if(!shortcuts[m_g1])return m_all;if(shortcuts[m_g1]==layout)return"\n";else return"\t"});value=value.replace(/\t+\n/g,"\n").replace(/\n\t+/g,"\n");value=value.replace(/\t+/g," ").replace(/\n/g,eol);this.param(key,value)}}}for(var key in this.params){if(key.match(/^_?(txt|offer)/)){var value=adm.substitute(this.params[key],this.params);this.params[key]=this.callbacks[key]?this.callbacks[key](value):value}}},waitForWindowSize:function(callback){var self=this;var size=adm.getInnerWindowSize();this.trace("Window size: "+size.width+"x"+size.height);if(size.width&&size.height){this.width=size.width;this.height=size.height;callback()}else{if(this.domRetries-- >0){this.trace("Will retry in 250ms");setTimeout(function(){self.waitForWindowSize(callback)},250);return}else{return this.doError("Failed to measure DOM window/iframe size after "+this.domTimeout+" seconds.")}}},populateImageQueue:function(){for(var key in this.params){if(key.match(/^_?(img|inv)_/)&&!key.match(/_u$/)){var elem=adm.$(key);if(elem){if(this.params[key]&&this.params[key].match(/\.(\w+)(\?|$)/)){var ext=RegExp.$1.toLowerCase();var width=elem.offsetWidth;var height=elem.offsetHeight;if(width&&height){var iparams={};if(this.args.overrides&&this.args.overrides[key]){iparams=this.args.overrides[key]}if(this.retina){if(this.args.roverrides&&this.args.roverrides[key]){iparams=this.args.roverrides[key]}width*=2;height*=2;if(iparams.width)iparams.width*=2;if(iparams.height)iparams.height*=2}var url="";if(this.params[key].match(/^(\w+\:\/\/)([\w\-\.\:]+)(.+)$/)){this.params[key]=RegExp.$1+this.cacheHost+RegExp.$3}if(!this.params[key].match(/^(\w+\:|\/)/)&&this.templateBaseURL){url=this.templateBaseURL+"/"}url+=this.params[key];if(url.match(/\?/))url+="&";else url+="?";url+="t=tr/w:"+(iparams.width||width)+"/h:"+(iparams.height||height)+"/m:"+(iparams.image_resize_mode||this.params.image_resize_mode);url+=iparams.image_suffix||this.params.image_suffix;if(iparams["image_suffix_"+ext])url+=iparams["image_suffix_"+ext];else if(this.params["image_suffix_"+ext])url+=this.params["image_suffix_"+ext];if(url.match(/\&t\=t\/Trim\:\%7B\%7D/)){url=url.replace(/\&t\=t\/Trim\:\%7B\%7D/,"");url=url.replace(/^(.+)\?([^\?]+)$/,"$1"+"?t=t/Trim:%7B%7D&"+"$2")}if(this.callbacks[key])url=this.callbacks[key](url);if(url.match(/^rf\:([^\:]+)\:(.+)$/)){url=this.proto+"//"+this.cacheHost+"/abc/assets/"+RegExp.$1+"/"+RegExp.$2}if(this.proto.match(/https/i))url=url.replace(/^http\:/i,"https:");else url=url.replace(/^https\:/i,"http:");if(this.templateModDate)url+="&mod="+this.templateModDate;if(this.params.source)url+="&source="+this.params.source;if(this.retina)url+="&retina=1";if(!this.params.local||url.match(/^\w+\:\/\//)){this.images[key]={url:url}}else if(this.params.local&&!url.match(/^\w+\:\/\//)){this.images[key]={url:url.replace(/\?.*$/,"")}}}else{this.trace("Image element has no size in DOM: "+key);return false}}}}}if(this.args.ifonts){var ifonts=this.args.ifonts;for(var elem_id in ifonts){var elem=adm.$(elem_id);if(elem&&this.params[elem_id]&&!elem_id.match(/^inv_/)){var dv_url=this.getiFontURL(elem_id);if(dv_url){this.images[elem_id]={url:dv_url}}else{this.trace("iFont element has no size in DOM: "+elem_id);return false}}}}return true},getiFontURL:function(){var elem_id="";var ifont={};if(arguments.length==2){elem_id=arguments[0]||"";ifont=arguments[1]||{}}else{if(typeof arguments[0]=="string")elem_id=arguments[0]||"";else ifont=arguments[0]||{};
}var ifonts=this.args.ifonts||{};if(!ifont)ifont={};if(ifonts.defaults){for(var key in ifonts.defaults){if(typeof ifont[key]=="undefined")ifont[key]=ifonts.defaults[key]}}if(elem_id){if(ifonts[elem_id]){for(var key in ifonts[elem_id]){if(typeof ifont[key]=="undefined")ifont[key]=ifonts[elem_id][key]}}if(this.params[elem_id]){if(!ifont.text)ifont.text=this.params[elem_id]}var elem=adm.$(elem_id);if(elem){if(!ifont.width)ifont.width=elem.offsetWidth;if(!ifont.height)ifont.height=elem.offsetHeight;var attribs_raw=elem.getAttribute("ifont")||"";while(attribs_raw.match(/(\w+)\:\s*([^\;]+)\;?/)){var ikey=RegExp.$1;var ivalue=RegExp.$2;if(ikey=="color"&&ivalue.match(/^\d$/))ivalue=parseInt(ivalue);ifont[ikey]=ivalue;attribs_raw=attribs_raw.replace(/(\w+)\:([^\;]+)\;?/,"")}}}if(!ifont.font)ifont.font="arial";if(!ifont.font.match(/^\w+$/)&&!ifont.font.match(/^rf\:/))ifont.font="rf:global:fonts/"+ifont.font;if(!ifont.format)ifont.format="png";if(!ifont.background)ifont.background="transparent";if(!ifont.quality)ifont.quality=70;if(!ifont.palette)ifont.palette=128;if(!ifont.dither)ifont.dither=false;if(typeof ifont.color=="number")ifont.color=this.color(ifont.color)||"";if(ifont.metrics){delete ifont.metrics;return ifont}if(!ifont.width||!ifont.height)return"";if(ifont.width*ifont.height>2048*2048)return"";if(this.retina){ifont.width*=2;ifont.height*=2}var dv_url=this.proto+"//"+this.cacheHost+"/rimfire/dv."+ifont.format;dv_url+="?account=ifont";dv_url+="&t=tnew/w:"+ifont.width+"/h:"+ifont.height+"/b:"+ifont.background;if(typeof ifont.text!="undefined"&&ifont.text!==null&&ifont.text!==false&&ifont.text!==""){var tt={te:(""+ifont.text).replace(/<.*?>/g,""),fo:ifont.font,ps:ifont.size||ifont.height,gr:ifont.location||"center",fi:(ifont.color||"black").replace(/\W+/g,""),aa:typeof ifont.antialias!="undefined"?ifont.antialias:4,as:typeof ifont.autoscale!="undefined"?ifont.autoscale:"shrink",x:ifont.xoffset||0,y:ifont.yoffset||0,mx:ifont.marginx||0,my:ifont.marginy||0,ww:ifont.wordwrap||0,k:ifont.kerning||0,ls:ifont.linespacing||0,f:"raw"};if(ifont.shadow){tt.sh=1;tt.sha=ifont.shadow_angle||0;tt.shd=ifont.shadow_dist||0;tt.shf=(ifont.shadow_color||"000000").replace(/\W+/g,"");if(ifont.shadow_blur)tt.shb=ifont.shadow_blur;if(ifont.shadow_opacity)tt.sho=ifont.shadow_opacity}if(ifont.maxlines)tt.MaxLines=ifont.maxlines;if(ifont.htrim)tt.htrim=1;if(this.retina){tt.ps*=2;tt.x*=2;tt.y*=2;tt.mx*=2;tt.my*=2;if(tt.ww.toString().match(/^\d{2,}$/))tt.ww=parseInt(tt.ww)*2;tt.k*=2;tt.ls*=2}dv_url+="&t=tt";for(var key in tt){dv_url+="/"+key+":"+encodeURIComponent(tt[key]).replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")}}var iparams={};if(elem_id&&this.args.overrides&&this.args.overrides[elem_id]){iparams=this.args.overrides[elem_id]}if(iparams.image_suffix)dv_url+=iparams.image_suffix;if(iparams["image_suffix_"+ifont.format])url+=iparams["image_suffix_"+ifont.format];else{if(ifont.format.match(/(png|gif)/i)){dv_url+="&t=tq/co:"+ifont.palette+"/di:"+(ifont.dither?"true":"false")}else if(ifont.format.match(/jpe?g?/i)){dv_url+="&t=ts/q:"+ifont.quality}}if(this.params.source)dv_url+="&source="+this.params.source;if(this.retina)dv_url+="&retina=1";this.trace("Constructed iFont URL: "+dv_url);return dv_url},loadCustomImage:function(url,key,callback){var self=this;if(!key)key=((new Date).getTime().toString()+Math.random().toString()).replace(/\D+/g,"");this.images[key]={url:url};if(this.allImagesLoaded){this.trace("Lazy-loading image: "+key+": "+url);var image=this.images[key];image.img=new Image;image.img.onload=function(){self.trace("Image loaded successfully: "+this.src);if(callback)callback()};image.img.onerror=function(){self.doError("Failed to load image: "+this.src);if(callback)callback()};image.img.src=url}else if(callback){this.on("load_complete",callback)}},loadImages:function(callback){var self=this;if("img_lma_logo"in this.params&&this.params.dma&&this.params.brand&&!this.params.lma_opt_out){var brand_cram=this.params.brand.toString().toLowerCase().replace(/\W+/g,"");this.params.img_lma_logo=this.proto+"//"+this.cacheHost+"/abc/cobalt/_LOGOS_dma"+this.params.dma+"/"+brand_cram+".png?placeholder=PLACEHOLDER"}if(!this.populateImageQueue()){if(this.domRetries-- >0){this.trace("Will retry in 250ms");setTimeout(function(){self.loadImages(callback)},250);return}else{return this.doError("Failed to locate DOM elements to measure size.")}}var num_images=0;for(var key in this.images){if(this.images[key])num_images++}if(!num_images){callback();return}var allLoadedCallback=callback;if(this.params.fastload){allLoadedCallback=function(){self.dispatchEvent("images_complete")}}this.trace("Loading "+num_images+" images.");for(var key in this.images){var image=this.images[key];if(image){this.trace("Loading image: "+key+": "+image.url);image.img=new Image;image.img.onload=function(){self.trace("Image loaded successfully: "+this.src);num_images--;if(!num_images)allLoadedCallback()};image.img.onerror=function(){self.doError("Failed to load image: "+this.src);num_images--;if(!num_images)allLoadedCallback()};image.img.src=image.url}}if(this.params.fastload)callback()},populateDOMElements:function(){for(var key in this.params){if(key.match(/^_?(img|txt|offer|inv)_/)){var nkey=key.replace(/_u$/,"");var elems=document.querySelectorAll?document.querySelectorAll("#"+nkey+", ."+nkey):[adm.$(nkey)];if(elems&&elems.length&&elems[0]){for(var idx=0,len=elems.length;idx<len;idx++){var elem=elems[idx];if(this.images[nkey]){var url=this.images[nkey].url;this.trace("Setting image element: "+nkey+": "+url);if(elem.nodeName=="IMG")elem.src=url;else{elem.style.backgroundImage="url("+url+")";elem.innerHTML=""}if(this.vendorPrefix=="ms")elem.style.msInterpolationMode="bicubic";if(this.images[nkey+":hover"]){elem._adm_image_url=url;elem._adm_hover_url=this.images[nkey+":hover"].url;adm.addDOMEventListener(elem,"mouseover",function(){if(this.nodeName=="IMG")this.src=this._adm_hover_url;else this.style.backgroundImage="url("+this._adm_hover_url+")"});adm.addDOMEventListener(elem,"mouseout",function(){if(this.nodeName=="IMG")this.src=this._adm_image_url;else this.style.backgroundImage="url("+this._adm_image_url+")"})}if(this.images[nkey+":active"]){elem._adm_inactive_url=elem._adm_hover_url||url;elem._adm_active_url=this.images[kney+":active"].url;adm.addDOMEventListener(elem,"mousedown",function(){if(this.nodeName=="IMG")this.src=this._adm_active_url;else this.style.backgroundImage="url("+this._adm_active_url+")"});adm.addDOMEventListener(elem,"mouseup",function(){if(this.nodeName=="IMG")this.src=this._adm_inactive_url;else this.style.backgroundImage="url("+this._adm_inactive_url+")"})}}else if(nkey.match(/^_?(txt|offer)_/)){this.trace("Setting text element: "+nkey+": "+this.params[nkey]);elem.innerHTML=this.params[nkey]}if(key.match(/_u$/)){var url=this.params[key].toString().replace(/\;\w+$/,"");this.trace("Setting link element: "+key+": "+url);elem.style.cursor="pointer";elem.setAttribute("admhref",url);if(this.params[key].toString().match(/\;(\w+)$/)){elem.setAttribute("admeventtype",RegExp.$1)}if(elem.nodeName=="A"){elem.href=url;elem.setAttribute("target","_blank")}adm.addDOMEventListener(elem,"mouseup",function(e){if(adm.isRightClick(e))return false;adm.htmlad.click(this)})}}}}}var body=document.getElementsByTagName("body")[0];body.className+=" loaded";if(this.images["img_lma_logo"]&&this.images["img_lma_logo"].img&&this.images["img_lma_logo"].img.width==8&&this.images["img_lma_logo"].img.height==8){this.dispatchEvent("lma_logo_fallback");body.className+=" lma_logo_fallback"}},prepInventory:function(){var inv=this.inv={};this.trace("Preparing inventory scroller");inv.container=adm.$("inv_container");if(!inv.container)return this.doError("Inventory container element not found: inv_container");inv.container.style.overflow="hidden";inv.cWidth=inv.container.offsetWidth;inv.cHeight=inv.container.offsetHeight;this.trace("Inventory container is "+inv.cWidth+"x"+inv.cHeight);inv.microad=adm.$("inv_microad");if(!inv.microad)return this.doError("Microad element not found: inv_microad");inv.mLeft=inv.microad.offsetLeft;inv.mTop=inv.microad.offsetTop;inv.mWidth=inv.microad.offsetWidth;inv.mHeight=inv.microad.offsetHeight;this.trace("Microad container is "+inv.mWidth+"x"+inv.mHeight);inv.thumb=adm.$("inv_thumb");if(inv.thumb){var tWidth=inv.thumb.offsetWidth;var tHeight=inv.thumb.offsetHeight;if(this.retina){tWidth*=2;tHeight*=2}inv.tQuery="?t=tr/w:"+tWidth+"/h:"+tHeight;inv.tQuery+="/m:"+(this.params.inv_image_resize_mode||this.params.image_resize_mode);inv.tQuery+=this.params.image_suffix;inv.tQuery+=this.params.inv_image_suffix||this.params.image_suffix_jpg||"";this.trace("Microad thumb query: "+inv.tQuery)}inv.microad_fallback=adm.$("inv_microad_fallback")},populateInvChildren:function(elem,ad,microad){var children=elem.children;if(children&&children.length){for(var idx=0,len=children.length;idx<len;idx++){var child=children[idx];if(child.id&&child.id.match(/^inv_(\w+)$/)){var path="/"+RegExp.$1.replace(/_/g,"/");if(child.id=="inv_thumb"){var url=ad.imageurl+this.inv.tQuery;if(this.callbacks[child.id])url=this.callbacks[child.id](url);if(this.params.source)url+="&source="+this.params.source;if(this.retina)url+="&retina=1";if(url.match(/_CAUTOS_/)){if(this.params.inv_s3&&ad.s3){url=url.replace(/^(\w+\:\/\/)([\w\-\.]+)/,"$1"+this.params.inv_s3);this.params.inv_static=1;ad.singleimage=1}if(this.params.inv_static){if(!this.params.inv_s3&&!ad.singleimage){url=url.replace(/(i\-\d+)(\.JPG)(\?|$)/i,"$1_S$2$3")}if(!this.params.inv_static_custom){child.style.backgroundRepeat="no-repeat";child.style.backgroundPosition="center center";child.style.backgroundSize="contain";if(url.match(/m\:fitpad/i)){var clr="#fff";if(url.match(/b\:(\w{6})/))clr="#"+RegExp.$1;child.style.backgroundColor=clr}else if(url.match(/m\:fitover/i)){child.style.backgroundSize="cover"}}url=url.replace(/\?.+$/,"")}}microad.thumb_url=url;microad.thumb_elem=child;if(this.vendorPrefix=="ms")child.style.msInterpolationMode="bicubic";child.innerHTML=""}else if(child.id=="inv_cpo_overlay"){child.style.display=ad.certified==1?"":"none";child.style.opacity=ad.certified==1?1:0}else if(child.id.match(/^inv_custom/)&&this.params[child.id]){var value=adm.substitute(this.params[child.id],ad);value=this.callbacks[child.id]?this.callbacks[child.id](value,child,ad):value;if(this.args.ifonts&&this.args.ifonts[child.id]&&value.toString().length){if(!microad.ifonts)microad.ifonts=[];microad.ifonts.push({id:child.id,elem:child,text:value});child.innerHTML=""}else{child.innerHTML=value}}else{var value=adm.lookupPath(path,ad);if(typeof value=="undefined")value="";value=this.callbacks[child.id]?this.callbacks[child.id](value,child,ad):value;if(this.args.ifonts&&this.args.ifonts[child.id]&&value.toString().length){if(!microad.ifonts)microad.ifonts=[];microad.ifonts.push({id:child.id,elem:child,text:value});child.innerHTML=""}else{child.innerHTML=value}}child.id+="|"+ad.id}this.populateInvChildren(child,ad,microad)}}},showInventory:function(ads){var self=this;var inv=this.inv;inv.ads=ads;inv.direction=this.params.inv_orientation;inv.microads=[];this.trace("Rendering inventory scroller ("+inv.direction+")");adm.hide("inv_fallback");inv.clone=inv.microad.cloneNode(true);adm.hide("inv_microad");if(inv.microad_fallback){inv.clone_fallback=inv.microad_fallback.cloneNode(true);adm.hide("inv_microad_fallback")}var len=0;if(inv.direction=="horiz"){len=ads.length+Math.ceil(inv.cWidth/(inv.mLeft+inv.mWidth))}else{len=ads.length+Math.ceil(inv.cHeight/(inv.mTop+inv.mHeight))}for(var idx=0;idx<len;idx++){var ad=ads[idx%ads.length];if(idx<ads.length)this.trace("Rendering microad: "+ad.ID);(function(ad){var div=null;if(self.params.payment_info){if(ad.PaymentInfo)div=inv.clone.cloneNode(true);else if(inv.clone_fallback)div=inv.clone_fallback.cloneNode(true);else div=inv.clone.cloneNode(true)}else div=inv.clone.cloneNode(true);var microad={div:div};div.id+="|"+ad.ID;div.style.position="absolute";var ad_lc=adm.deepCopyLowerKeys(ad);self.populateInvChildren(div,ad_lc,microad);if(microad.thumb_url)ad_lc.thumburl=microad.thumb_url;delete microad.imageurl;div.setAttribute("admhref",ad.Detaillink||"");div.setAttribute("admadid",ad.ID);div.setAttribute("admeventtype","inventory");inv.container.appendChild(div);adm.addDOMEventListener(div,"mouseup",function(e){if(adm.isRightClick(e))return false;if(self.listeners.invclick&&self.listeners.invclick.length){self.dispatchEvent("invclick",ad_lc,div)}else adm.htmlad.click(this)});self.dispatchEvent("invrender",ad_lc,div);inv.microads.push(microad)})(ad)}inv.scrollPos=0;inv.lastPos=-1;inv.scrollDelta=parseFloat(this.params.inv_auto_scroll);inv.scrollDeltaMax=parseFloat(this.params.inv_scroll_speed);inv.mouseScrollArea=parseFloat(this.params.inv_mouse_scroll);inv.scrollDegrade=parseFloat(this.params.inv_scroll_degrade);inv.ssEnable=this.params.inv_ss_enable||false;inv.ssEase=parseFloat(this.params.inv_ss_ease);inv.ssLoadPadding=parseInt(this.params.inv_ss_load_padding);inv.ssIdx=0;inv.ssTargetPos=0;if(inv.direction=="horiz"){inv.scrollMax=(inv.mLeft+inv.mWidth)*ads.length}else{inv.scrollMax=(inv.mTop+inv.mHeight)*ads.length}this.invScrollAnimate();adm.addDOMEventListener(inv.container,"mousemove",function(e){if(!e)e=window.event;var x=typeof e.clientX=="number"?e.clientX:e.pageX;var y=typeof e.clientY=="number"?e.clientY:e.pageY;var temp=inv.container,cx=0,cy=0;while(temp){cx+=temp.offsetLeft;cy+=temp.offsetTop;temp=temp.offsetParent}x-=cx;y-=cy;var amt=0;if(inv.direction=="horiz")amt=x/inv.cWidth;else amt=y/inv.cHeight;if(amt<inv.mouseScrollArea){inv.scrollDelta=0-(inv.mouseScrollArea-amt)/inv.mouseScrollArea*inv.scrollDeltaMax}else if(amt>1-inv.mouseScrollArea){inv.scrollDelta=(amt-(1-inv.mouseScrollArea))/inv.mouseScrollArea*inv.scrollDeltaMax}else{inv.scrollDelta=0}});setInterval(function(){adm.htmlad.invScrollAnimate()},Math.floor(1e3/30))},invGetSlideShowCount:function(){var inv=this.inv||{};if(!inv.ads)return 0;return inv.ads.length},invGetSlideShowIdx:function(){var inv=this.inv||{};var idx=inv.ssIdx||0;if(idx<0)idx+=inv.ads.length;if(idx>=inv.ads.length)idx-=inv.ads.length;return idx},invNavSlideShow:function(idx){var inv=this.inv||{};if(inv.ssEnable){inv.ssIdx=parseInt(idx);if(inv.ssIdx<0)inv.ssIdx=0;if(inv.ssIdx>=inv.ads.length)inv.ssIdx=inv.ads.length-1;if(inv.direction=="horiz"){inv.ssTargetPos=inv.ssIdx*(inv.mLeft+inv.mWidth)}else{inv.ssTargetPos=inv.ssIdx*(inv.mTop+inv.mHeight)}}},invAdvanceSlideShow:function(delta){var inv=this.inv||{};if(inv.ssEnable){inv.ssIdx+=delta;if(inv.direction=="horiz"){inv.ssTargetPos=inv.ssIdx*(inv.mLeft+inv.mWidth)}else{inv.ssTargetPos=inv.ssIdx*(inv.mTop+inv.mHeight)}}},invScrollAnimate:function(){var inv=this.inv;if(inv.scrollDelta!=0){inv.scrollPos+=inv.scrollDelta;if(inv.scrollPos<0)inv.scrollPos+=inv.scrollMax;else if(inv.scrollPos>=inv.scrollMax)inv.scrollPos-=inv.scrollMax;inv.scrollDelta*=inv.scrollDegrade;if(Math.abs(inv.scrollDelta)<.01)inv.scrollDelta=0}if(inv.ssEnable){if(Math.abs(inv.scrollPos-inv.ssTargetPos)<.1){inv.scrollPos=inv.ssTargetPos}else{inv.scrollPos+=(inv.ssTargetPos-inv.scrollPos)*inv.ssEase}if(inv.scrollPos<0){inv.scrollPos+=inv.scrollMax;inv.ssTargetPos+=inv.scrollMax;inv.ssIdx+=inv.ads.length}else if(inv.scrollPos>=inv.scrollMax){inv.scrollPos-=inv.scrollMax;inv.ssTargetPos-=inv.scrollMax;inv.ssIdx-=inv.ads.length}}var pos=Math.floor(inv.scrollPos);if(pos!=inv.lastPos){inv.lastPos=pos;var x=0;var y=0;for(var idx=0,len=inv.microads.length;idx<len;idx++){var microad=inv.microads[idx];var need_img_load=false;if(inv.direction=="horiz"){x=Math.floor(0-pos+(inv.mLeft+inv.mWidth)*idx);microad.div.style.left=""+x+"px";if(x>=0-inv.mWidth-inv.ssLoadPadding&&x<inv.cWidth+inv.ssLoadPadding){need_img_load=true}}else{y=Math.floor(0-pos+(inv.mTop+inv.mHeight)*idx);microad.div.style.top=""+y+"px";if(y>=0-inv.mHeight-inv.ssLoadPadding&&y<inv.cHeight+inv.ssLoadPadding){need_img_load=true}}if(need_img_load){if(microad.thumb_url){this.trace("Dynamically loading microad thumbnail image: "+microad.thumb_url);microad.thumb_elem.style.backgroundImage="url("+microad.thumb_url+")";delete microad.thumb_url}if(microad.ifonts){for(var idy=0,ley=microad.ifonts.length;idy<ley;idy++){var obj=microad.ifonts[idy];var url=this.getiFontURL(obj.id,{width:obj.elem.offsetWidth,height:obj.elem.offsetHeight,text:obj.text});this.trace("Dynamically loading microad iFont image: "+obj.id+": "+url);obj.elem.style.backgroundImage="url("+url+")"}delete microad.ifonts}}}}},hideInventory:function(){adm.hide("inv_microad");adm.show("inv_fallback")},dealerFallback:function(){adm.show("dealer_fallback");if(this.params.contacts){this.trace("No dealer found, but one was expected, so activating fallback behavior");for(var idx=0,len=this.dynamicDealerTextParams.length;idx<len;idx++){this.params[this.dynamicDealerTextParams[idx]]=""}if(this.params.fallback_hide){for(var key in this.params.fallback_hide){adm.hide(key)}}if(this.params.fallback_show){for(var key in this.params.fallback_show){adm.show(key)}}if(this.params.defaulturl){this.trace("Replacing txt_link_u with defaulturl: "+this.params.defaulturl);this.params.txt_link_u=this.params.defaulturl}if(this.params.fallback_custom)this.params.fallback_custom();this.dispatchEvent("dealer_fallback")}},click:function(elem,merge_url,query_append){var self=this;if(typeof elem=="string")elem=adm.$(elem.replace(/_u$/,""));if(!elem)return this.doError("Unable to locate element for click");var url=elem.getAttribute("admhref");if(!url)return;var orig_url=url;var event_name=elem.getAttribute("admeventtype")||"brand_link_click";var num=elem.getAttribute("admeventnum")||1;for(var idx=0,len=this.clickRemaps.length;idx<len;idx++){var remap=this.clickRemaps[idx];url=url.replace(remap[0],remap[1])}if(merge_url&&merge_url.match(/^\?custom/i))merge_url="";if(merge_url&&merge_url.match(/^\&/))merge_url=merge_url.replace(/^\&/,"?");var replace_uri="";var merge_query="";if(merge_url&&merge_url.split){var parts=merge_url.split(/\?/,2);if(parts[0])replace_uri=parts[0];if(parts[1])merge_query=parts[1]}if(replace_uri&&window._dad&&_dad.providers){replace_uri=this.getStandardProviderURI(replace_uri)}if(replace_uri&&url.match(/^(\w+\:\/\/[\w\-\.\:]+)([^\?]*)(.*)$/)){var proto_hostname=RegExp.$1;var uri=RegExp.$2;var qs=RegExp.$3;if(!replace_uri.match(/^\//))replace_uri="/"+replace_uri;url=proto_hostname+replace_uri+qs}if(merge_query){merge_query=adm.parseQueryString(merge_query);var parts=url.split(/\?/,2);var query=adm.parseQueryString(parts[1]||"");for(var key in merge_query)query[key]=merge_query[key];url=parts[0]+adm.composeQueryString(query)}this.trace("Click: "+elem.id+": "+url);this.dispatchEvent("click",elem,url);if(elem.nodeName!="A"){var click_url=url;if(this.params.lqs){click_url+=(click_url.match(/\?/)?"&":"?")+this.params.lqs.replace(/^[\?\&]/,"")}if(this.lastOffer&&!this.lastOffer.ID.toString().match(/FILLER/)){click_url+=(click_url.match(/\?/)?"&":"?")+"cs:adm:o="+this.lastOffer.ID}if(query_append){click_url+=(click_url.match(/\?/)?"&":"?")+query_append.toString().replace(/^[\?\&]/,"")}if(this.params.click_redirect){click_url=this.params.click_redirect+click_url}else if(this.params.trackingredirecturl){click_url=this.params.trackingredirecturl+click_url}click_url=click_url.replace(/\s+/g,"");click_url=click_url.toString().replace(/\{ad\:([\w\.]+)\}/g,function(m_all,m_g1){return encodeURIComponent(self.params[m_g1.replace(/\W+/g,"_")]||self.params[m_g1.replace(/\W+/g,"")]||"")});this.trace("Final click URL: "+click_url);if(adm.mraid){mraid.open(click_url)}else if(this.listeners.externalclick&&this.listeners.externalclick.length){this.dispatchEvent("externalclick",click_url,url)}else window.open(click_url);this.logEvent("click",{elem_id:elem.id,original_url:orig_url,final_url:click_url,merge_url:merge_url||"",lqs:this.params.lqs||"",query_append:query_append||""})}if(window._dad&&_dad.adClicked)_dad.adClicked();else if(this.params.pubclick_pixeltracker&&this.params.pubclick_pixeltracker.match(/^(\w+\:)?\/\/\S+$/)){this.trace("Firing click pixel tracker: "+this.params.pubclick_pixeltracker);(new Image).src=this.params.pubclick_pixeltracker}},getStandardProviderURI:function(uri){var prov_id=this.param("provider")||"Cobalt/CDK";var provider=_dad.providers[prov_id];if(!uri.match(/^(make|model|service|directions|fallback|default)$/))return uri;if(!provider||!provider.links[uri]||provider.links[uri]=="/")return"";var macro_args={condition:this.param("condition")||"new",make:this.param("tx_make")||"",model:this.param("tx_model")||""};if(macro_args.condition=="cpo")macro_args.condition="used";macro_args.condition=provider.condition[macro_args.condition]||"new";for(var key in macro_args){switch(provider.encoding){case"taxonomy":macro_args[key]=encodeURIComponent(macro_args[key]);break;case"taxonomy_double_enc":macro_args[key]=encodeURIComponent(encodeURIComponent(macro_args[key]));break;case"crammified":macro_args[key]=macro_args[key].toString().toLowerCase().replace(/\W+/g,"");break}}if(uri=="model"&&!macro_args.model)uri="make";if(uri=="make"&&!macro_args.make)uri="fallback";var new_uri=provider.links[uri].replace(/\[(\w+)\]/g,function(m_all,m_g1){return macro_args[m_g1]||m_all});this.trace("Click URI rewrite for "+uri+" via provider "+prov_id+": "+new_uri);return new_uri},logEvent:function(action,args){if(action=="error"){this.errors.push(JSON.parse(JSON.stringify(args)))}args.action=action;args.order=this.params.adcreator_order||"";args.template=this.params.adcreator_template||"";args.contact_id=this.params.contact_id||this.params.contactid||"";args.ua=navigator.userAgent;args.layout=this.params.layout||"";if(this.lastOffer)args.offer=this.lastOffer.ID||"";if(this.params.audit)args.audit=1;if(window.tp){if(tp.campaign_id)args.campaign_id=tp.campaign_id;if(tp.chan)args.chan=tp.chan;if(tp.creative_id)args.creative_id=tp.creative_id;if(tp.place)args.place=tp.place;if(tp.session_id)args.session_id=tp.session_id;if(tp.size)args.size=tp.size;if(tp.system)args.system=tp.system;if(tp.uid)args.uid=tp.uid}try{args.host=location.host;if(document.referrer.toString().match(/^\w+\:\/\/([\w\-\.]+)/)){args.ref=RegExp.$1}}catch(e){}var log_host=this.cacheHost;if(window._dad&&_dad.parms&&_dad.parms.cachehost)log_host=_dad.parms.cachehost;else if(window.extParams&&extParams.cachehost)log_host=extParams.cachehost;var url=this.proto+"//"+log_host+"/webapp/utils/html5/log.php"+adm.composeQueryString(args);(new Image).src=url},setStyles:function(){var id=null,elem=null,sty=null,overrides=null,key=null,styles={};if(arguments.length==1)styles=arguments[0];else styles[arguments[0]]=arguments[1];for(id in styles){overrides=styles[id];var elems=[];if(id.match(/^[\w\-]+$/)&&document.getElementById(id))elems=[document.getElementById(id)];else if(document.querySelectorAll)elems=document.querySelectorAll(id);if(elems.length&&this.params&&this.params.local)this.trace("Setting styles on target: "+id+": "+JSON.stringify(overrides));for(var idx=0,len=elems.length;idx<len;idx++){var elem=elems[idx];if(elem){sty=elem.style;for(key in overrides){var sKey=key.replace(/^\-/,"").replace(/\-(\w)/g,function(m_all,m_g1){return m_g1.toUpperCase()});sty[sKey]=overrides[key];if(!key.match(this.cssStdProps)){sty[this.vendorPrefix+sKey.substring(0,1).toUpperCase()+sKey.substring(1)]=overrides[key]}}}}}},animatePlay:function(){var body=document.getElementsByTagName("body")[0];if(this.cssAnimationSupport){if(!body.className.match(/\banimation\b/))body.className+=" animation"}else{if(!body.className.match(/\bfallback\b/))body.className+=" fallback"}if(!this.cssAnimationSupport)return false;var self=this;var selectors=this.args.animation||{};if(this.animationTimers&&this.animationTimers.length){this.animateRewind()}this.animationTimers=[];this.trace("Playing animation");for(var sel in selectors){var timeline=selectors[sel];if(this.animationDefaults.visibility=="visible"){this.setStyles(sel,{visibility:"hidden"})}for(var offset in timeline){var props=timeline[offset];var ms=parseFloat(offset)*1e3;if(typeof props=="string")props={animation:props};for(var key in this.animationDefaults){if(typeof props[key]=="undefined"){props[key]=this.animationDefaults[key]}}(function(isel,ims,iprops){self.animationTimers.push(setTimeout(function(){if(self.param("local"))self.trace("Animation Keyframe: "+isel+": "+ims+"ms: "+JSON.stringify(iprops));iprops["animation-play-state"]="running";self.dispatchEvent("keyframe",isel,ims,iprops);self.setStyles(isel,iprops)},ims))})(sel,ms,props)}}var divs=document.getElementsByTagName("div");for(var idx=0,len=divs.length;idx<len;idx++){var sty=divs[idx].style;if(sty){sty.animationPlayState="running";sty.webkitAnimationPlayState="running"}}var temp=adm.$("#template");if(temp&&temp.style)temp.style.visibility="visible";this.dispatchEvent("play");return true},animateStop:function(){if(!this.cssAnimationSupport)return false;var selectors=this.args.animation||{};this.trace("Stopping animation");if(this.animationTimers&&this.animationTimers.length){for(var idx=0,len=this.animationTimers.length;idx<len;idx++){clearTimeout(this.animationTimers[idx])}}for(var sel in selectors){this.setStyles(sel,{"animation-play-state":"paused"})}var divs=document.getElementsByTagName("div");for(var idx=0,len=divs.length;idx<len;idx++){var sty=divs[idx].style;if(sty){sty.animationPlayState="paused";sty.webkitAnimationPlayState="paused"}}this.dispatchEvent("stop");return true},animateRewind:function(){if(!this.cssAnimationSupport)return false;var selectors=this.args.animation||{};if(this.animationTimers&&this.animationTimers.length){this.animateStop()}this.trace("Rewinding animation");for(var sel in selectors){this.setStyles(sel,{animation:"","animation-name":""});if(this.animationDefaults.visibility=="visible"){this.setStyles(sel,{visibility:"hidden"})}}var body=document.getElementsByTagName("body")[0];body.classList.remove("animation");body.offsetWidth;var temp=adm.$("#template");if(temp&&temp.style)temp.style.visibility="hidden";this.dispatchEvent("rewind");return true},color:function(idx){var clrs=(this.param("colors")||"").split(/\,\s*/);var clr=clrs[idx]||"";if(clr&&!clr.match(/^\#/))clr="#"+clr;return clr},param:function(){if(arguments.length==2)this.params[arguments[0]]=arguments[1];else return this.params[arguments[0]]},override:function(){if(!this.args.overrides)this.args.overrides={};if(arguments.length==3){var elem_id=arguments[0];var key=arguments[1];var value=arguments[2];if(!this.args.overrides[elem_id])this.args.overrides[elem_id]={};this.args.overrides[elem_id][key]=value}else if(arguments.length==2){var elem_id=arguments[0];var obj=arguments[1];if(!this.args.overrides[elem_id])this.args.overrides[elem_id]={};for(var key in obj)this.args.overrides[elem_id][key]=obj[key]}else return this.args.overrides[arguments[0]]},on:function(name,callback){name=name.toLowerCase();if(!this.listeners[name])this.listeners[name]=[];this.listeners[name].push(callback);return this},dispatchEvent:function(){var name=arguments[0].toLowerCase();if(this.params&&this.params.local)this.trace("Dispatching event: "+name);if(this.listeners[name]||this.listeners["all"]){var args=[];if(arguments.length>1){for(var idx=1,len=arguments.length;idx<len;idx++){args.push(arguments[idx])}}if(this.listeners[name]){for(var idx=0,len=this.listeners[name].length;idx<len;idx++){this.listeners[name][idx].apply(window,args)}}if(this.listeners["all"]){for(var idx=0,len=this.listeners["all"].length;idx<len;idx++){this.listeners["all"][idx].apply(window,[name].concat(args))}}}},trace:function(msg){if(this.debug&&window.console&&console.log){console.log(adm.timeNow()+": "+msg)}}};adm.timeNow=function(){return(new Date).getTime()/1e3};adm.parseCookies=function(){var cookies={};var pairs=null;if(window._dad&&_dad.admCookies){for(var key in _dad.admCookies)cookies[key]=_dad.admCookies[key]}try{pairs=document.cookie.split(/\;\s*/)}catch(e){}if(!pairs)return{};for(var idx=0,len=pairs.length;idx<len;idx++){var pair=pairs[idx];if(pair.match(/^([^\=]+)\=(.*)$/)){cookies[RegExp.$1]=adm.decodeURIComponent(RegExp.$2)}}return cookies};adm.parseQueryString=function(queryString){var pair=null;var queryObject={};queryString=queryString.replace(/^.*\?(.+)$/,"$1");while((pair=queryString.match(/([^=]+)=([^\&]*)\&?/))&&pair[0].length){queryString=queryString.substring(pair[0].length);pair[1]=adm.decodeURIComponent(pair[1]);pair[2]=adm.decodeURIComponent(pair[2]);if(/^\-?\d+$/.test(pair[2]))pair[2]=parseInt(pair[2],10);queryObject[pair[1]]=pair[2]}return queryObject};adm.composeQueryString=function(queryObj){var qs="";for(var key in queryObj){qs+=(qs.length?"&":"?")+encodeURIComponent(key)+"="+encodeURIComponent(queryObj[key])}return qs};adm.encodeAttribEntities=function(text){if(text==null)return"";if(text&&text.replace){text=text.replace(/\&/g,"&amp;");text=text.replace(/</g,"&lt;");text=text.replace(/>/g,"&gt;");text=text.replace(/\"/g,"&quot;");text=text.replace(/\'/g,"&apos;")}return text};adm.$=function(id){var obj=null;if(id.match(/^[\w\-]+$/))obj=document.getElementById(id);else if(document.querySelector)obj=document.querySelector(id);if(obj){if(!obj.hide)obj.hide=function(){this.style.display="none";return this};if(!obj.show)obj.show=function(){this.style.display="";this.style.opacity=1;this.style.visibility="visible";return this};if(!obj.addClass)obj.addClass=function(name){this.removeClass(name);this.className+=" "+name;return this};if(!obj.removeClass)obj.removeClass=function(name){this.className=this.className.replace(new RegExp("\\s*"+name+"\\s*","g")," ").replace(/^\s+/,"").replace(/\s+$/,"");return this};if(!obj.replaceClass)obj.replaceClass=function(old_class,new_class){return this.removeClass(old_class).addClass(new_class)};if(!obj.hasClass)obj.hasClass=function(name){return!!this.className.match(new RegExp("\\b"+name+"\\b"))}}return obj};if(!adm.force_iframe){adm.show=function(){var elem=null;for(var idx=0,len=arguments.length;idx<len;idx++){elem=adm.$(arguments[idx]);if(elem){elem.style.display="";elem.style.opacity=1;elem.style.visibility="visible"}}};adm.hide=function(){var elem=null;for(var idx=0,len=arguments.length;idx<len;idx++){elem=adm.$(arguments[idx]);if(elem)elem.style.display="none"}};adm.deepCopyLowerKeys=function(obj){var result={};if(typeof obj.length=="number"&&typeof obj[0]!="undefined"){result=[];for(var idx=0,len=obj.length;idx<len;idx++){if(typeof obj[idx]=="object")result[idx]=adm.deepCopyLowerKeys(obj[idx]);else result[idx]=obj[idx]}}else{for(var key in obj){if(typeof obj[key]=="object")result[key.toLowerCase()]=adm.deepCopyLowerKeys(obj[key]);else result[key.toLowerCase()]=obj[key]}}return result};adm.lookupPath=function(path,obj){if(!path.match(/^\//))path="/"+path;while(path.match(/^\/([^\/]+)/)){var key=RegExp.$1;if(typeof obj[key]!="object")return obj[key];obj=obj[key];path=path.replace(/^\/([^\/]+)/,"")}return obj};adm.substitute=function(text,args){if(typeof text=="undefined")text="";text=""+text;if(!args)args={};while(text.indexOf("[")>-1){var open_bracket=text.indexOf("[");var close_bracket=text.indexOf("]");var before=text.substring(0,open_bracket);var after=text.substring(close_bracket+1,text.length);var name=text.substring(open_bracket+1,close_bracket);var value="";if(!name.match(/^\//))name="/"+name;value=adm.lookupPath(name,args);if(typeof value=="undefined")value="";text=before+value+after}return text};adm.addDOMEventListener=function(elem,evt,func){if(elem.addEventListener){elem.addEventListener(evt,func,false)}else if(elem.attachEvent){elem.attachEvent("on"+evt,function(e){if(!e)e=window.event;func.call(elem,e)})}};adm.commify=function(number){if(!number)number=0;number=""+number;number=number.replace(/\.\d+$/,"").replace(/\D+/g,"");if(number.length>3){var mod=number.length%3;var output=mod>0?number.substring(0,mod):"";for(i=0;i<Math.floor(number.length/3);i++){if(mod==0&&i==0)output+=number.substring(mod+3*i,mod+3*i+3);else output+=","+number.substring(mod+3*i,mod+3*i+3)}return output}else return number;
};adm.price_usd=function(value,hide_zeros){var matches=value.toString().replace(/^\-/,"").replace(/\,+/g,"").match(/^(\d+)\.(\d+)$/);if(matches){if(matches[2].length<2)matches[2]="0"+matches[2];else if(matches[2].length>2)matches[2]=matches[2].substring(0,2);return"$"+adm.commify(matches[1])+"."+matches[2]}else return"$"+adm.commify(value)+(hide_zeros?"":".00")};adm.price_usd_int=function(value){return adm.price_usd(value.toString().replace(/\.\d+$/,""),true)};adm.isRightClick=function(e){if(!e)var e=window.event;var right=false;if(e.which)right=e.which==3;else if(e.button)right=e.button==2;return right};adm.getInnerWindowSize=function(dom){if(!dom)dom=window;var w=0,h=0;if(typeof dom.innerWidth=="number"){w=dom.innerWidth;h=dom.innerHeight}else if(dom.document.documentElement&&(dom.document.documentElement.clientWidth||dom.document.documentElement.clientHeight)){w=dom.document.documentElement.clientWidth;h=dom.document.documentElement.clientHeight}else if(dom.document.body&&(dom.document.body.clientWidth||dom.document.body.clientHeight)){w=dom.document.body.clientWidth;h=dom.document.body.clientHeight}return{width:w,height:h}};adm.decodeURIComponent=function(text){try{text=decodeURIComponent(text)}catch(e){}return text};if(!String.toTitleCase)String.toTitleCase=function(str){return(""+str).toLowerCase().replace(/(^|\W+)([a-z])/g,function(m_all,m_g1,m_g2){return m_g1+m_g2.toUpperCase()})};if(!window.JSON)window.JSON={};if(!JSON.stringify)JSON.stringify=function(obj){return"[UNSUPPORTED BROWSER]"};if(window.extParams&&extParams.preview||window._dad&&_dad.parms&&_dad.parms.preview){window.onerror=function(message,url,linenum,colnum,err){var msg="HTML Ad JavaScript Error: "+message+" (in "+url+" on line "+linenum+")";if(err&&err.stack)msg+="\n\n"+err.stack;else msg+="\n\n(No stack trace available)";if(window.console&&console.log){console.log(msg)}if(!adm.num_error_alerts)adm.num_error_alerts=0;adm.num_error_alerts++;if(adm.num_error_alerts<10){alert(msg+"\n\n"+navigator.userAgent)}}}else if(window._dad&&Math.random()<=adm.htmlad.logErrorPct/100){window.onerror=function(message,url,linenum,colnum,err){var stack=err&&err.stack?err.stack:"";adm.htmlad.logEvent("error",{message:message,url:url,linenum:linenum,stack:stack});window.onerror=null}}if(document.readyState==="complete"){adm.domLoaded=true}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){adm.domLoaded=true},false)}else{window.attachEvent("onload",function(){adm.domLoaded=true})}}if(!adm.custom)adm.custom={};adm.cs=adm.custom;adm.ad=adm.htmlad;if(typeof mraid!="undefined")adm.mraid=mraid;(function(){if(window._dad&&_dad.parms&&_dad.parms.adcreator_template&&_dad.parms.layout&&_dad.parms.cachehost){if(adm.force_iframe){if(window.tp&&typeof tp=="object"){for(var key in tp)_dad.parms["tp_"+key]=tp[key]}if(adm.mraid||_dad.parms.modern){var ifr=document.createElement("iframe");ifr.src=""+location.protocol+"//"+_dad.parms.cachehost+"/webapp/utils/displayad_iframe.php"+adm.composeQueryString(_dad.parms);var sty=ifr.style;sty.width=""+_dad.parms.spotw+"px";sty.height=""+_dad.parms.spoth+"px";sty.border="0";sty.margin="0";sty.padding="0";document.body.appendChild(ifr)}else{var iframe_url=""+location.protocol+"//"+_dad.parms.cachehost+"/webapp/utils/displayad_iframe.php"+adm.composeQueryString(_dad.parms);document.write('<iframe src="'+iframe_url+'" style="width:'+_dad.parms.spotw+"px; height:"+_dad.parms.spoth+'px; border:0; margin:0; padding:0;" border="0" frameborder="0"></iframe>')}}else{adm.htmlad.templateBaseURL=""+adm.htmlad.proto+"//"+_dad.parms.cachehost+"/abc/assets/"+_dad.parms.adcreator_template.replace(/^rf\:/,"").replace(/\:/g,"/");var script_ttl=3600;if(_dad.parms.preview||_dad.parms.debug||_dad.parms.cachehost.match(/\b(dev|stage|preprod)\b/))script_ttl=1;var script_url=adm.htmlad.templateBaseURL+"/"+_dad.parms.layout+".js?cache="+script_ttl;var div_id="adm_htmlad_container";if(location.href.match&&location.href.match(/[\?\&]adm_replay\=1\b/)){}else if(adm.mraid||_dad.parms.modern){var cont=document.createElement("div");cont.id=div_id;var sty=cont.style;sty.position="relative";sty.overflow="hidden";sty.width=_dad.parms.hero?"100%":""+_dad.parms.spotw+"px";sty.height=_dad.parms.hero?"100%":""+_dad.parms.spoth+"px";document.body.appendChild(cont);var scr=document.createElement("script");scr.setAttribute("type","text/javascript");scr.setAttribute("crossorigin","anonymous");scr.setAttribute("charset","utf-8");scr.src=script_url;document.body.appendChild(scr)}else{if(_dad.parms.hero)document.write('<div id="'+div_id+'" style="position:relative;overflow:hidden;width:100%;height:100%;"></div>');else document.write('<div id="'+div_id+'" style="position:relative;overflow:hidden;width:'+_dad.parms.spotw+"px;height:"+_dad.parms.spoth+'px;"></div>');document.write("<scr"+'ipt type="text/javascript" crossorigin="anonymous" charset="utf-8" src="'+script_url+'"></scr'+"ipt>")}}}})();function arrBufToB64(r){var a="";var v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var n=new Uint8Array(r);var e=n.byteLength;var f=e%3;var i=e-f;var t,o,u,c;var l;for(var s=0;s<i;s=s+3){l=n[s]<<16|n[s+1]<<8|n[s+2];t=(l&16515072)>>18;o=(l&258048)>>12;u=(l&4032)>>6;c=l&63;a+=v[t]+v[o]+v[u]+v[c]}if(f==1){l=n[i];t=(l&252)>>2;o=(l&3)<<4;a+=v[t]+v[o]+"=="}else if(f==2){l=n[i]<<8|n[i+1];t=(l&64512)>>10;o=(l&1008)>>4;u=(l&15)<<2;a+=v[t]+v[o]+v[u]+"="}return a}(function(){if(typeof window.CustomEvent==="function")return false;function CustomEvent(event,params){params=params||{bubbles:false,cancelable:false,detail:null};var evt=document.createEvent("CustomEvent");evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt}window.CustomEvent=CustomEvent})();if(window._dad&&_dad.admCookies&&_dad.admCookies.ADMSNIFFER&&!adm.force_iframe){setTimeout(function(){adm.ad.preSniffAd()},1)}

				
				try{
					
(function(){ 
   var scr = document.createElement('script'); 
   var first_scr = document.getElementsByTagName('script')[0]; 
   scr.async = 1; 
   scr.src = ("https:" == document.location.protocol ? 'https' : 'http') + '://c.betrad.com/durly.js?;ad_w=728;ad_h=90;coid=740;nid=607;ad_z=999999;'; 
   first_scr.parentNode.insertBefore(scr, first_scr); 
})();

				}catch(e){}
				
				
			}
			catch(e){
				
			}